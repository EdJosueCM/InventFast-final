{% extends 'core/base.html' %}
{% load static %}

{% block title %}Dashboard{% endblock %}
{% block page_title %}Panel Principal{% endblock %}

{% block content %}

<!-- CONTENEDOR DE GRÁFICOS -->
<!-- CONTENEDOR DE GRÁFICOS MÁS PEQUEÑOS -->
<div class="flex flex-wrap justify-center gap-4 px-4">

    <!-- GRÁFICO DE STOCK -->
    <div class="bg-white shadow-md rounded-xl p-4 w-[40rem]">
        <h2 class="text-base font-semibold mb-3 text-gray-800 text-center">Stock</h2>
        <div class="bg-gray-100 p-2 rounded-xl shadow-inner h-[260px]">
            <canvas id="stockChart" class="w-full h-full"></canvas>
        </div>
    </div>

    <!-- GRÁFICO DE VENTAS -->
    <div class="bg-white shadow-md rounded-xl p-4 w-[40rem]">
        <h2 class="text-base font-semibold mb-3 text-gray-800 text-center">Ventas por Mes</h2>

        <form method="get" class="mb-2 text-center">
            <label for="mes" class="mr-2 font-medium text-gray-700 text-sm">Mes:</label>
            <select name="mes" id="mes" onchange="this.form.submit()" class="px-2 py-1 text-sm rounded border border-gray-300 focus:outline-none focus:ring focus:border-indigo-500">
                {% for num, nombre in meses %}
                    <option value="{{ num }}" {% if num == mes_actual %}selected{% endif %}>{{ nombre }}</option>
                {% endfor %}
            </select>
        </form>

        <div class="bg-gray-100 p-2 rounded-xl shadow-inner h-[260px]">
            <canvas id="ventasChart" class="w-full h-full"></canvas>
        </div>
    </div>

    <!-- GRÁFICO DE MENOS SALIDA -->
    <div class="bg-white shadow-md rounded-xl p-4 w-[40rem]">
        <h2 class="text-base font-semibold mb-3 text-gray-800 text-center">Menos Salida</h2>
        <div class="bg-gray-100 p-2 rounded-xl shadow-inner h-[260px]">
            <canvas id="productosMenosVendidosChart" class="w-full h-full"></canvas>
        </div>
    </div>

</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    window.nombresProductos = {{ nombres|safe }};
    window.cantidadesStock = {{ cantidades|safe }};
    window.diasVentas = {{ dias|safe }};
    window.totalesVentas = {{ totales|safe }};
    window.menosNombres = {{ menos_nombres|safe }};
    window.menosCantidades = {{ menos_cantidades|safe }};
</script>
<script src="{% static 'core/js/dashboard_charts.js' %}"></script>
{% endblock %}
